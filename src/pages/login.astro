---
import Layout from '../layouts/Layout.astro';
import Toast from '../components/Toast.astro';
---

<Layout 
  title="Iniciar Sesi√≥n - Taller Industrial Brenes"
  description="Acceso administrativo al sistema de gesti√≥n de Taller Industrial Brenes"
>
  <main class="min-h-screen bg-gradient-to-br from-primary-800 to-dark-800 flex items-center justify-center py-12">
    <div class="max-w-md w-full mx-4">
      <div class="bg-white rounded-2xl shadow-2xl p-8">
        <!-- Logo -->
        <div class="text-center mb-8">
          <img 
            src="/images/logoletrasblancas.png" 
            alt="Taller Industrial Brenes" 
            class="h-16 mx-auto mb-4"
          />
          <h1 class="text-2xl font-bold text-dark-800">Panel Administrativo</h1>
          <p class="text-gray-600 mt-2">Acceso al sistema de gesti√≥n</p>
        </div>
        
        <!-- Formulario de login -->
        <form id="login-form">
          <div class="mb-6">
            <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
              Correo electr√≥nico
            </label>
            <input 
              type="email" 
              id="email" 
              name="email" 
              required
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-accent-500 focus:border-transparent"
              placeholder="admin@tallerbrenes.com"
            />
          </div>
          
          <div class="mb-6">
            <label for="password" class="block text-sm font-medium text-gray-700 mb-2">
              Contrase√±a
            </label>
            <input 
              type="password" 
              id="password" 
              name="password" 
              required
              class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-accent-500 focus:border-transparent"
              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
            />
          </div>
          
          <div class="mb-6">
            <div class="flex items-center">
              <input 
                type="checkbox" 
                id="remember" 
                name="remember"
                class="h-4 w-4 text-accent-600 focus:ring-accent-500 border-gray-300 rounded"
              />
              <label for="remember" class="ml-2 block text-sm text-gray-700">
                Recordarme
              </label>
            </div>
          </div>
          
          <button 
            type="submit"
            class="w-full inline-flex items-center justify-center gap-3 bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white font-bold text-lg px-8 py-4 rounded-full shadow-xl hover:shadow-primary-500/25 transform hover:scale-105 transition-all duration-300 border border-primary-400/20 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none mb-4"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
             <!--<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path> --> 
            </svg>
            Iniciar Sesi√≥n
            <svg class="w-4 h-4 ml-1 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <!--<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
          -->   </svg>
          </button>
          
          <div class="text-center JUSTIFY-CENTER mt-4">
            <a href="/" class="text-sm text-accent-600 hover:text-accent-800">
              ‚Üê Volver al sitio principal
            </a>
          </div>
        </form>
        
        <!-- Informaci√≥n de desarrollo -->
        <div class="mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-xl">
          <div class="text-sm text-yellow-800">
            <strong>Modo demostraci√≥n:</strong><br>
            La autenticaci√≥n se implementar√° con Supabase en una versi√≥n futura.
          </div>
        </div>
      </div>
    </div>
  </main>
  
  <Toast />
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('login-form') as HTMLFormElement;
    
    form?.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const formData = new FormData(form);
      const email = formData.get('email') as string;
      const password = formData.get('password') as string;
      
      if (!email || !password) {
        window.showError('Por favor complete todos los campos');
        return;
      }
      
      const button = form.querySelector('button[type="submit"]') as HTMLButtonElement;
      const originalText = button.textContent;
      button.disabled = true;
      button.textContent = 'Iniciando sesi√≥n...';
      
      try {
        // Simular autenticaci√≥n
        await new Promise(resolve => setTimeout(resolve, 1500));
        
        // En el futuro, aqu√≠ se implementar√≠a Supabase Auth
        window.showToast('üîÑ Funci√≥n en desarrollo. La autenticaci√≥n se implementar√° con Supabase.', { type: 'info' });
        
        // Simular redirecci√≥n exitosa (descomenta para probar)
        // setTimeout(() => {
        //   window.location.href = '/panel';
        // }, 2000);
        
      } catch (error) {
        console.error('Error de login:', error);
        window.showError('Error al iniciar sesi√≥n');
      } finally {
        button.disabled = false;
        button.textContent = originalText;
      }
    });
  });
</script>