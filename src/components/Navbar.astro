---
import BusinessStatus from './BusinessStatus.astro';

const currentPath = Astro.url.pathname;
---

<nav id="navbar" class="bg-gradient-to-r from-black/90 via-dark-900/90 to-black/90 backdrop-blur-md sticky top-0 z-50 shadow-lg border-b border-white/5 transition-all duration-300">
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between py-4">
      <!-- Logo -->
      <div class="flex items-center">
        <a 
          href="/" 
          class="block hover:scale-105 transition-transform duration-300 group"
          aria-label="Ir al inicio - Taller Industrial Brenes"
        >
          <img 
            src="https://zjpgpagdnpmfgmesglvv.supabase.co/storage/v1/object/public/images/LogoTBrenesLetrasBlancas.png"
            alt="Taller Industrial Brenes Logo" 
            class="h-14 w-auto cursor-pointer filter drop-shadow-lg group-hover:drop-shadow-xl transition-all"
          />
        </a>
      </div>
      
      <!-- Navigation Links -->
      <div class="hidden md:flex items-center space-x-2">
        <a 
          href="/" 
          class={`nav-link relative text-white px-5 py-2 rounded-lg transition-all duration-300 font-medium ${
            currentPath === '/' ? 'text-accent-400 bg-white/10' : 'hover:text-accent-300 hover:bg-white/5'
          }`}
        >
          Inicio
          {currentPath === '/' && <span class="nav-indicator"></span>}
        </a>
        <a 
          href="/servicios" 
          class={`nav-link relative text-white px-5 py-2 rounded-lg transition-all duration-300 font-medium ${
            currentPath === '/servicios' ? 'text-accent-400 bg-white/10' : 'hover:text-accent-300 hover:bg-white/5'
          }`}
        >
          Servicios
          {currentPath === '/servicios' && <span class="nav-indicator"></span>}
        </a>
        <a 
          href="/productos" 
          class={`nav-link relative text-white px-5 py-2 rounded-lg transition-all duration-300 font-medium ${
            currentPath === '/productos' ? 'text-accent-400 bg-white/10' : 'hover:text-accent-300 hover:bg-white/5'
          }`}
        >
          Galería
          {currentPath === '/productos' && <span class="nav-indicator"></span>}
        </a>
        <a 
          href="/contacto" 
          class={`nav-link relative text-white px-5 py-2 rounded-lg transition-all duration-300 font-medium ${
            currentPath === '/contacto' ? 'text-accent-400 bg-white/10' : 'hover:text-accent-300 hover:bg-white/5'
          }`}
        >
          Contacto
          {currentPath === '/contacto' && <span class="nav-indicator"></span>}
        </a>
        <div class="ml-4 pl-4 border-l border-white/10">
          <BusinessStatus id="status-indicator-desktop" />
        </div>
      </div>
      
      <!-- Mobile Menu Button -->
      <div class="md:hidden">
        <button 
          id="mobile-menu-button" 
          class="text-white hover:text-accent-300 p-2"
          aria-label="Abrir menú"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
    </div>
    
    <!-- Mobile Menu -->
    <div id="mobile-menu" class="md:hidden hidden pb-4 border-t border-white/10 mt-2">
      <div class="flex flex-col space-y-1 pt-2">
        <a 
          href="/" 
          class={`text-white px-4 py-3 rounded-lg transition-all duration-300 ${
            currentPath === '/' ? 'bg-white/10 text-accent-400' : 'hover:bg-white/5 hover:text-accent-300'
          }`}
        >
          Inicio
        </a>
        <a 
          href="/servicios" 
          class={`text-white px-4 py-3 rounded-lg transition-all duration-300 ${
            currentPath === '/servicios' ? 'bg-white/10 text-accent-400' : 'hover:bg-white/5 hover:text-accent-300'
          }`}
        >
          Servicios
        </a>
        <a 
          href="/productos" 
          class={`text-white px-4 py-3 rounded-lg transition-all duration-300 ${
            currentPath === '/productos' ? 'bg-white/10 text-accent-400' : 'hover:bg-white/5 hover:text-accent-300'
          }`}
        >
          Galería
        </a>
        <a 
          href="/contacto" 
          class={`text-white px-4 py-3 rounded-lg transition-all duration-300 ${
            currentPath === '/contacto' ? 'bg-white/10 text-accent-400' : 'hover:bg-white/5 hover:text-accent-300'
          }`}
        >
          Contacto
        </a>
        <div class="px-4 py-3 border-t border-white/10 mt-2">
          <BusinessStatus id="status-indicator-mobile" />
        </div>
      </div>
    </div>
  </div>
</nav>

<style>
  /* Indicador de página activa */
  .nav-indicator {
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 60%;
    height: 2px;
    background: linear-gradient(90deg, transparent, #fbbf24, transparent);
    animation: slideIn 0.3s ease-out;
  }

  @keyframes slideIn {
    from {
      width: 0%;
      opacity: 0;
    }
    to {
      width: 60%;
      opacity: 1;
    }
  }

  /* Efecto hover en links */
  .nav-link::before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%) scaleX(0);
    width: 60%;
    height: 2px;
    background: linear-gradient(90deg, transparent, rgba(251, 191, 36, 0.5), transparent);
    transition: transform 0.3s ease;
  }

  .nav-link:hover::before {
    transform: translateX(-50%) scaleX(1);
  }

  /* Efecto scroll en navbar */
  #navbar.scrolled {
    @apply shadow-2xl bg-gradient-to-r from-black via-dark-900 to-black border-b border-white/10;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const button = document.getElementById('mobile-menu-button');
    const menu = document.getElementById('mobile-menu');
    const navbar = document.getElementById('navbar');
    
    // Toggle mobile menu
    button?.addEventListener('click', () => {
      menu?.classList.toggle('hidden');
    });

    // Cerrar menú móvil al hacer clic en un enlace
    const mobileLinks = menu?.querySelectorAll('a');
    mobileLinks?.forEach(link => {
      link.addEventListener('click', () => {
        menu?.classList.add('hidden');
      });
    });

    // Efecto scroll en navbar
    let lastScroll = 0;
    window.addEventListener('scroll', () => {
      const currentScroll = window.pageYOffset;
      
      if (currentScroll > 50) {
        navbar?.classList.add('scrolled');
      } else {
        navbar?.classList.remove('scrolled');
      }
      
      lastScroll = currentScroll;
    });
  });
</script>